## 队列

队列的特点是先进者先出，拥有入队、出队两个操作。

特性：`在队头取数组、队尾添加数据。`

类别：`顺序队列`、`链式队列`、`循环队列`、`阻塞队列`、`并发队列`

#### 顺序队列

顺序队列，用数组方式存储，需要head、tail两个指针。当tail指向队尾，队列未满，此时添加数据时，
数据需要进行搬移，复杂度为O(n)。使用循环队列可以避免数据搬移操作。

数组实现的有界队列，队列的大小有限，设置一个合理的队列大小，也是非常有讲究的。

#### 链式队列

链式队列，用head、tail两个指针，分别指向队头和队尾。使用链表的形式进行关联。

链式队列是一个支持无限排队的无界队列

#### 循环队列

循环队列是顺序队列的基础上做了改变，解决了数组搬移操作的痛点。。

循环队列浪费了一个数组的存储空间。实现循环队列时，需要考虑队满和队空的情况。

公式式如下：

* `队满  (tail+1)%n=head`

* `对空  tail=head`


#### 阻塞、并发队列

阻塞队列其实就是在队列基础上增加了阻塞操作。简单来说，就是在队列为空的时候，从队头取数据会被阻塞。

多线程情况下，一个线程安全的队列我们叫作并发队列。基于数组的循环队列，利用 CAS 原子操作，可以实现非常高效的并发队列。

## 时间复杂度

出队  `O(1)`

入队  `O(1)`

## 思考 🤔

并发队列，关于如何实现无锁并发队列？

## 练习

1）[实现顺序队列]() :green_apple:

2）[实现链式队列]() :green_apple:

3）[实现循环队列]() :green_apple:

4）[设计一个双端队列](https://github.com/lzle/leetcode/tree/master/note/641) :lemon:

4）[滑动窗口最大值](https://github.com/lzle/leetcode/tree/master/note/206) :apple:


## 解答

1）无锁并发队列？

`使用 CAS 实现无锁队列，则在入队前，获取 tail 位置，入队时比较 tail 是否发生变化，如果否，则允许入队，反之，本次入队失败。出队则是获取 head 位置，进行 CAS`

2）CAS？

`Compare And Set（或Compare And Swap），CAS 是解决多线程并行情况下使用锁造成性能损耗的一种机制，采用这种无锁的原子操作可以实现线程安全，避免加锁的笨重性。`

`CAS 操作包含三个操作数：内存位置（V）、预期原值（A）、新值(B)。`

`如果内存位置的值与预期原值相等，那么处理器会自动将该位置值更新为新值。否则，处理器不做任何操作。`

`无论哪种情况，它都会在 CAS 指令之前返回该位置的值。CAS 有效地说明了“我认为位置V应该包含值A；如果包含该值，则将B放到这个位置；否则，不要更改该位置，只告诉我这个位置现在的值即可。”`

`在java中可以通过循环CAS的方式来实现原子操作。`

`CAS是实现自旋锁的基础，CAS 利用 CPU 指令保证了操作的原子性，以达到锁的效果，循环这个指令，直到成功为止。`

`java提供的CAS原子操作类AtomicInteger等，核心就是CAS（CompareAndSwap）。`
